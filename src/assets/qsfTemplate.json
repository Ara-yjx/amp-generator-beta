{
  "SurveyEntry": {
    "SurveyID": "SV_dnAkDKOddKsPTpQ",
    "SurveyName": "SPT",
    "SurveyDescription": null,
    "SurveyOwnerID": "UR_8qrlYLU2jfq7Cqa",
    "SurveyBrandID": "upenn",
    "DivisionID": null,
    "SurveyLanguage": "EN",
    "SurveyActiveResponseSet": "RS_6zXdxkXXWoWLKL4",
    "SurveyStatus": "Active",
    "SurveyStartDate": "0000-00-00 00:00:00",
    "SurveyExpirationDate": "0000-00-00 00:00:00",
    "SurveyCreationDate": "2023-07-08 05:22:35",
    "CreatorID": "UR_8qrlYLU2jfq7Cqa",
    "LastModified": "2023-10-01 05:30:15",
    "LastAccessed": "0000-00-00 00:00:00",
    "LastActivated": "2023-09-09 05:47:48",
    "Deleted": null
  },
  "SurveyElements": [
    {
      "SurveyID": "SV_dnAkDKOddKsPTpQ",
      "Element": "BL",
      "PrimaryAttribute": "Survey Blocks",
      "SecondaryAttribute": null,
      "TertiaryAttribute": null,
      "Payload": [
        {
          "Type": "Default",
          "Description": "Load parameters",
          "ID": "BL_cJgbZWbXtlZwIQe",
          "BlockElements": [
            {
              "Type": "Question",
              "QuestionID": "QID1"
            }
          ]
        },
        {
          "Type": "Trash",
          "Description": "Trash \/ Unused Questions",
          "ID": "BL_3FesUeo9uvib7y6",
          "BlockElements": [],
          "Options": {
            "BlockLocking": "false",
            "RandomizeQuestions": "false",
            "BlockVisibility": "Collapsed"
          }
        },
        {
          "Type": "Standard",
          "SubType": "",
          "Description": "Run Trials",
          "ID": "BL_3EDLHCLtBlrl7oO",
          "BlockElements": [
            {
              "Type": "Question",
              "QuestionID": "QID2"
            }
          ]
        }
      ]
    },
    {
      "SurveyID": "SV_dnAkDKOddKsPTpQ",
      "Element": "FL",
      "PrimaryAttribute": "Survey Flow",
      "SecondaryAttribute": null,
      "TertiaryAttribute": null,
      "Payload": {
        "Type": "Root",
        "FlowID": "FL_1",
        "Flow": [
          {
            "Type": "EmbeddedData",
            "FlowID": "FL_3",
            "EmbeddedData": [
              {
                "Description": "stimuli_1_items",
                "Type": "Custom",
                "Field": "stimuli_1_items",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false,
                "Value": "[{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_zANlu6B1UFbcflF\",\"count\":5},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_vQzlOEGBXbnuhSn\",\"count\":5},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_XJw0GZWrbUlfyOI\",\"count\":5},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_E72k4fxbh7Zxw7e\",\"count\":5},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_RFsC6tV9IGidru4\",\"count\":5},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_M4wae3Z0GjWQRkD\",\"count\":5},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_F9fpRim5SiLGU8t\",\"count\":5},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_xLUoASyb57j7ezR\",\"count\":5}]"
              },
              {
                "Description": "stimuli_1_shuffle",
                "Type": "Custom",
                "Field": "stimuli_1_shuffle",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false,
                "Value": "2"
              },
              {
                "Description": "stimuli_2_items",
                "Type": "Custom",
                "Field": "stimuli_2_items",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false,
                "Value": "[{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_3jUT9yhSx8mI5wy\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_25WNyckTIXiv4bQ\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_9HRiGBCgN50xZI2\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_bqP6msi7K3SPhPM\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_8q8uD7MVCDyWdzo\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_5jy9Uo2ZV2BaPki\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_3KIqzYFkmmCv3cq\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_2lYARTfPvNPiwF8\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_8CagBSGuqa3103k\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_eXWu2juJ3IFpiia\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_9t0w55KTUPY9uK2\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_5jo1Wq1EpYoas3s\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_81blvWQpZDlael8\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_0U7PxswipvQuNrU\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_2gZtO50zqBd39B4\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_2aQYOy04gO7kx4G\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_9yt21bg0o84Tt9c\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_03srJoTDehJb2V8\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_4YIfcyT8d1xghlI\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_8qUdZ0CwAXeCKxM\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_6QCRchjKW1dGhcG\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_4HLhYK2seAX1opw\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_2gF10eQOSwdHxfo\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_8qucEPy2K0oFkWy\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_2tULPzYl2dk6eiO\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_3r3a5Z2Ruguka7s\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_3en7w39WHobUvoW\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_abX7fBDnVzvPSjc\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_dnUHxQckvLbEV4a\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_agwjmD9fGQMcawK\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_3OjfkCyc7ZmCBym\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_eP6i52QjuzksfRA\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_1HeeVDSoYiQspE2\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_7X1IdJXN98qbVhI\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_e8rwUgorjxXXSuy\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_9poogxcVq9oAkQe\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_d73fKrvvmZqxFn8\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_8ogT3ozEpraFUto\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_0roC8vKyNFfu8wS\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_bIb0xXbDx6JVL5Y\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_3QxQYuy313umdmu\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_e3F1LOHphmo0w98\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_8kwWckkggPMtpWe\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_0MoXFM69zQnFxEq\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_0pkHgkE3ck2IaOO\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_2f0J3X3u1gVwoBg\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_b88sQUZ7HZURpdQ\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_cN0xpyB0oYo4rVs\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_9vk06qTobnmwRlc\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_1ZIuviqhK3uETBA\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_ePDdYlUD7iHUx7g\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_eRJnNWh2BpJfv5c\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_0GSkjfufXlNmYpU\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_afpeLjDOMD1i3Hw\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_6Lm9B6qm4EgmO0u\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_82s7sXnHN1InklE\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_6thdUpsXpgOQefs\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_0SzgDcIaL7N8EZw\",\"count\":\"1\"},{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/ControlPanel\/Graphic.php?IM=IM_8I0kGbUUJ1U3HRI\",\"count\":\"1\"}]"
              },
              {
                "Description": "stimuli_2_shuffle",
                "Type": "Custom",
                "Field": "stimuli_2_shuffle",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false,
                "Value": "true"
              },
              {
                "Description": "stimuli_3_items",
                "Type": "Custom",
                "Field": "stimuli_3_items",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false,
                "Value": "[{\"content\":\"https:\/\/upenn.co1.qualtrics.com\/CP\/Graphic.php?IM=IM_bQlal1oB5kyb60m\",\"count\":\"40\"}]"
              },
              {
                "Description": "stimuli_3_shuffle",
                "Type": "Custom",
                "Field": "stimuli_3_shuffle",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false,
                "Value": "false"
              },
              {
                "Description": "stimuli_1_duration",
                "Type": "Custom",
                "Field": "stimuli_1_duration",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false,
                "Value": "75"
              },
              {
                "Description": "stimuli_1_interval",
                "Type": "Custom",
                "Field": "stimuli_1_interval",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false,
                "Value": "125"
              },
              {
                "Description": "stimuli_2_duration",
                "Type": "Custom",
                "Field": "stimuli_2_duration",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false,
                "Value": "100"
              },
              {
                "Description": "stimuli_2_interval",
                "Type": "Custom",
                "Field": "stimuli_2_interval",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false,
                "Value": "125"
              },
              {
                "Description": "delay_before_keyboard",
                "Type": "Custom",
                "Field": "delay_before_keyboard",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false,
                "Value": "100"
              },
              {
                "Description": "delay_after_keyboard",
                "Type": "Custom",
                "Field": "delay_after_keyboard",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false,
                "Value": "100"
              },
              {
                "Description": "accepted_keys",
                "Type": "Custom",
                "Field": "accepted_keys",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false,
                "Value": "d,k"
              },
              {
                "Description": "total_trials",
                "Type": "Custom",
                "Field": "total_trials",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false,
                "Value": "40"
              },
              {
                "Description": "auto_proceed_timeout",
                "Type": "Custom",
                "Field": "auto_proceed_timeout",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false,
                "Value": "4000"
              },
              {
                "Description": "stimuli_1_prime",
                "Type": "Custom",
                "Field": "stimuli_1_prime",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false,
                "Value": "[{\"name\": \"learned_1\", \"include\": [1],\"override_count\": 20},{\"name\": \"control_1\", \"exclude\": [\"learned_1\"]}]"
              },
              {
                "Description": "stimuli_2_prime",
                "Type": "Recipient",
                "Field": "stimuli_2_prime",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false
              },
              {
                "Description": "stimuli_3_prime",
                "Type": "Recipient",
                "Field": "stimuli_3_prime",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false
              }
            ]
          },
          {
            "Type": "EmbeddedData",
            "FlowID": "FL_4",
            "EmbeddedData": [
              {
                "Description": "stimuli_1_shuffle_result",
                "Type": "Recipient",
                "Field": "stimuli_1_shuffle_result",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false
              },
              {
                "Description": "stimuli_2_shuffle_result",
                "Type": "Recipient",
                "Field": "stimuli_2_shuffle_result",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false
              },
              {
                "Description": "stimuli_3_shuffle_result",
                "Type": "Recipient",
                "Field": "stimuli_3_shuffle_result",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false
              },
              {
                "Description": "trial_responses",
                "Type": "Recipient",
                "Field": "trial_responses",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false
              },
              {
                "Description": "trial_response_durations",
                "Type": "Recipient",
                "Field": "trial_response_durations",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false
              },
              {
                "Description": "stimuli_1_prime_result",
                "Type": "Recipient",
                "Field": "stimuli_1_prime_result",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false
              },
              {
                "Description": "stimuli_2_prime_result",
                "Type": "Recipient",
                "Field": "stimuli_2_prime_result",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false
              },
              {
                "Description": "stimuli_3_prime_result",
                "Type": "Recipient",
                "Field": "stimuli_3_prime_result",
                "VariableType": "String",
                "DataVisibility": [],
                "AnalyzeText": false
              }
            ]
          },
          {
            "Type": "Block",
            "ID": "BL_cJgbZWbXtlZwIQe",
            "FlowID": "FL_2",
            "Autofill": []
          },
          {
            "Type": "Standard",
            "ID": "BL_3EDLHCLtBlrl7oO",
            "FlowID": "FL_5",
            "Autofill": []
          }
        ],
        "Properties": {
          "Count": 6,
          "RemovedFieldsets": []
        }
      }
    },
    {
      "SurveyID": "SV_dnAkDKOddKsPTpQ",
      "Element": "PL",
      "PrimaryAttribute": "Preview Link",
      "SecondaryAttribute": null,
      "TertiaryAttribute": null,
      "Payload": {
        "PreviewType": "Brand",
        "PreviewID": "6115033c-b61a-4566-9c05-d218626bb355"
      }
    },
    {
      "SurveyID": "SV_dnAkDKOddKsPTpQ",
      "Element": "SO",
      "PrimaryAttribute": "Survey Options",
      "SecondaryAttribute": null,
      "TertiaryAttribute": null,
      "Payload": {
        "BackButton": "false",
        "SaveAndContinue": "true",
        "SurveyProtection": "PublicSurvey",
        "BallotBoxStuffingPrevention": "false",
        "NoIndex": "Yes",
        "SecureResponseFiles": "true",
        "SurveyExpiration": "None",
        "SurveyTermination": "DefaultMessage",
        "Header": "",
        "Footer": "",
        "ProgressBarDisplay": "None",
        "PartialData": "+1 week",
        "ValidationMessage": "",
        "PreviousButton": " \u2190 ",
        "NextButton": " \u2192 ",
        "SurveyTitle": "Qualtrics Survey | Qualtrics Experience Management",
        "SkinLibrary": "upenn",
        "SkinType": "templated",
        "Skin": {
          "brandingId": null,
          "templateId": "*base",
          "overrides": null
        },
        "NewScoring": 1,
        "SurveyMetaDescription": "The most powerful, simple and trusted way to gather experience data. Start your journey to experience management and try a free account today.",
        "SurveyName": "SPT",
        "CustomStyles": [],
        "ProtectSelectionIds": true
      }
    },
    {
      "SurveyID": "SV_dnAkDKOddKsPTpQ",
      "Element": "QGO",
      "PrimaryAttribute": "QGO_QuotaGroupOrder",
      "SecondaryAttribute": null,
      "TertiaryAttribute": null,
      "Payload": [
        "QG_FH8Cdf0L5gg9uBa"
      ]
    },
    {
      "SurveyID": "SV_dnAkDKOddKsPTpQ",
      "Element": "SCO",
      "PrimaryAttribute": "Scoring",
      "SecondaryAttribute": null,
      "TertiaryAttribute": null,
      "Payload": {
        "ScoringCategories": [],
        "ScoringCategoryGroups": [],
        "ScoringSummaryCategory": null,
        "ScoringSummaryAfterQuestions": 0,
        "ScoringSummaryAfterSurvey": 0,
        "DefaultScoringCategory": null,
        "AutoScoringCategory": null
      }
    },
    {
      "SurveyID": "SV_dnAkDKOddKsPTpQ",
      "Element": "PROJ",
      "PrimaryAttribute": "CORE",
      "SecondaryAttribute": null,
      "TertiaryAttribute": "1.1.0",
      "Payload": {
        "ProjectCategory": "CORE",
        "SchemaVersion": "1.1.0"
      }
    },
    {
      "SurveyID": "SV_dnAkDKOddKsPTpQ",
      "Element": "STAT",
      "PrimaryAttribute": "Survey Statistics",
      "SecondaryAttribute": null,
      "TertiaryAttribute": null,
      "Payload": {
        "MobileCompatible": true,
        "ID": "Survey Statistics"
      }
    },
    {
      "SurveyID": "SV_dnAkDKOddKsPTpQ",
      "Element": "QC",
      "PrimaryAttribute": "Survey Question Count",
      "SecondaryAttribute": "3",
      "TertiaryAttribute": null,
      "Payload": null
    },
    {
      "SurveyID": "SV_dnAkDKOddKsPTpQ",
      "Element": "SQ",
      "PrimaryAttribute": "QID2",
      "SecondaryAttribute": "d key = less pleasant k key = more pleasant",
      "TertiaryAttribute": null,
      "Payload": {
        "QuestionText": "<img style=\"display: block; margin: 0 auto; width: 300px; height: 300px;\" id=\"amp-trial-img\"\/>\n<div style=\"display: flex; justify-content: space-around; margin-top: 6em;\">\n  <b><i>d key = less pleasant<\/i><\/b>\n  <b><i>k key = more pleasant<\/i><\/b>\n<\/div>",
        "DefaultChoices": false,
        "DataExportTag": "SPT",
        "QuestionType": "DB",
        "Selector": "TB",
        "Configuration": {
          "QuestionDescriptionOption": "UseText"
        },
        "QuestionDescription": "d key = less pleasant k key = more pleasant",
        "ChoiceOrder": [],
        "Validation": {
          "Settings": {
            "Type": "None"
          }
        },
        "GradingData": [],
        "Language": [],
        "NextChoiceId": 4,
        "NextAnswerId": 1,
        "QuestionID": "QID2",
        "QuestionJS": "const myGlobalThis = window.top;\n\nclass GlobalKeydownEventListener {\n  constructor() {\n    \/** @type {(key: string) -> any} *\/\n    this.callback = undefined;\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n    this.handleMessage = this.handleMessage.bind(this);\n    this.passKeydownToTopWindow = this.passKeydownToTopWindow.bind(this);\n  }\n  add() {\n    window.addEventListener('keydown', this.passKeydownToTopWindow);\n    window.top.addEventListener('keydown', this.handleKeyDown);\n    window.top.addEventListener('message', this.handleMessage);\n  }\n  remove() {\n    window.removeEventListener('keydown', this.passKeydownToTopWindow);\n    window.top.removeEventListener('keydown', this.handleKeyDown);\n    window.top.removeEventListener('message', this.handleMessage);\n  }\n  handleKeyDown(event) {\n    if (this.basicKeyFilter(event.key)) {\n      event.stopPropagation();\n      event.preventDefault();\n      this.callback && this.callback(event.key);\n    }\n  }\n  handleMessage(event) {\n    if (event.data.type === 'iframe-keydown') {\n      this.callback && this.callback(event.data.key);\n    }\n  }\n  \/**\n   * Pass keydown event from iframe to top window. \n   * Otherwise, in Qualtrics Preview, top window cannot receive keydown event if focus is on iframe\n   *\/\n  passKeydownToTopWindow(event) {\n    if (this.basicKeyFilter(event.key)) {\n      event.stopPropagation();\n      event.preventDefault();\n      window.top.postMessage({\n        type: 'iframe-keydown',\n        key: event.key,\n      });\n    }\n  }\n  basicKeyFilter(key) {\n    return (key.length === 1 && (\n      key >= '0' && key <= '9' || \n      key >= 'a' && key <= 'z' ||\n      key >= 'A' && key <= 'Z'\n    )) || (\n      ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(key)\n    );\n  }\n}\n\n\n\n\/** \n * @typedef {Object} StimuliPoolConfig\n * @property {{content:string, count:number}[]} items\n * @property {boolean|number} shuffle\n *\/\n\/**\n * @typedef {Object} Params\n * @property {StimuliPoolConfig[]} stimuli\n * @property {number[]} timeline\n * @property {string[]} acceptedKeys\n * @property {number} totalTrials\n * @property {number|null} autoProceedTimeout\n *\/\n\nif (!myGlobalThis.params) {\n  alert('Sorry. Critical error occured in the survey webpage. Please restart survey or contact the survey conductor.');\n}\n\nconst { stimuli, timeline, acceptedKeys, totalTrials, autoProceedTimeout } = myGlobalThis.params;\n\nmyGlobalThis.responses = [];\nmyGlobalThis.responseDurations = [];\nconst keyboardListener = new GlobalKeydownEventListener();\n\nQualtrics.SurveyEngine.addOnload(function () {\n\n  const thisQultricsQuestion = this;\n  this.hideNextButton();\n  this.hidePreviousButton();\n  this.hideChoices();\n\n  \/** @type { ImageElement } *\/\n  const imgEl = thisQultricsQuestion.questionContainer.querySelector('#amp-trial-img');\n  keyboardListener.add();\n\n\n  \/\/ Trial state machine:\n  \/\/ -> display stimuli -> await keyboard --@accepted-> retention -> $\n  \/\/                                      --@timeout---------------> $ \n  function runTrial(tid) {\n    let isAwaitingKeyboard = false;\n    let awaitKeyboardStartTime;\n    trialStartTime = performance.now();\n    console.debug('runTrial', tid)\n    setTimeout(() => {\n      imgEl.src = getContent(0, tid);\n    }, 0);\n    setTimeout(() => {\n      imgEl.style.visibility = 'hidden';\n    }, sliceSum(timeline, 1));\n    setTimeout(() => {\n      imgEl.style.visibility = 'visible';\n      imgEl.src = getContent(1, tid);\n    }, sliceSum(timeline, 2));\n    setTimeout(() => {\n      imgEl.style.visibility = 'hidden';\n    }, sliceSum(timeline, 3));\n    setTimeout(() => {\n      imgEl.style.visibility = 'visible';\n      imgEl.src = getContent(2, tid);\n    }, sliceSum(timeline, 4));\n    setTimeout(() => {\n      isAwaitingKeyboard = true;\n      awaitKeyboardStartTime = performance.now();\n    }, sliceSum(timeline, 5));\n    if (autoProceedTimeout !== null && autoProceedTimeout >= 0) {\n      setTimeout(() => {\n        if (isAwaitingKeyboard) {\n          isAwaitingKeyboard = false;\n          nextTrial(tid + 1);\n        }\n      }, sliceSum(timeline, 5) + autoProceedTimeout);\n    }\n\n    keyboardListener.callback = (key) => {\n      if (isAwaitingKeyboard) {\n        const formattedKey = key.length === 1 ? key.toLowerCase() : key;\n        if (acceptedKeys.includes(formattedKey)) {\n          isAwaitingKeyboard = false;\n          \/\/ retention after keyboard\n          const duration = Math.floor(performance.now() - awaitKeyboardStartTime);\n          pushResponse(tid, formattedKey, duration);\n          setTimeout(() => {\n            nextTrial(tid + 1);\n          }, timeline[5]); \/\/ NaN|undef|negative behaves like 0 \n        };\n      }\n    }\n  }\n\n  function nextTrial(newTid) {\n    myGlobalThis.currentTrial = newTid;\n    if (myGlobalThis.currentTrial >= totalTrials) {\n      console.log('[AMP] set trial_responses = ' + myGlobalThis.responses.join(','));\n      thisQultricsQuestion.clickNextButton();\n    } else {\n      runTrial(newTid);\n    }\n  }\n  nextTrial(0);\n\n  function pushResponse(tid, response, duration) {\n    myGlobalThis.responses[tid] = response;\n    myGlobalThis.responseDurations[tid] = duration;\n    const responsesString = myGlobalThis.responses.join(',');\n    const responseDurationsString = myGlobalThis.responseDurations.join(',');\n    Qualtrics.SurveyEngine.setEmbeddedData('trial_responses', responsesString);\n    Qualtrics.SurveyEngine.setEmbeddedData('trial_response_durations', responseDurationsString);\n    console.debug('trial_responses', responsesString);\n    console.debug('trial_response_durations', responseDurationsString);\n  }\n});\n\n\nQualtrics.SurveyEngine.addOnUnload(function () {\n  keyboardListener.remove();\n})\n\n\n\/**\n * Get content from stimuli or preload\n * @param {number} stimuliIndex \n * @param {number} trialIndex \n *\/\nfunction getContent(stimuliIndex, trialIndex) {\n  const contentIndex = stimuli[stimuliIndex].shuffledIndexes[trialIndex];\n  const content = stimuli[stimuliIndex].items[contentIndex].content;\n  const preload = myGlobalThis.preload[content];\n  return preload || content; \/\/ better use ?? here\n}\n\nfunction sliceSum(array, end) {\n  return array.slice(0, end).reduce((a, b) => a + b, 0);\n}",
        "DataVisibility": {
          "Private": false,
          "Hidden": false
        }
      }
    },
    {
      "SurveyID": "SV_dnAkDKOddKsPTpQ",
      "Element": "QG",
      "PrimaryAttribute": "QG_FH8Cdf0L5gg9uBa",
      "SecondaryAttribute": "Default Quota Group",
      "TertiaryAttribute": null,
      "Payload": {
        "ID": "QG_FH8Cdf0L5gg9uBa",
        "Name": "Default Quota Group",
        "Selected": true,
        "MultipleMatch": "PlaceInAll",
        "Public": false,
        "Quotas": []
      }
    },
    {
      "SurveyID": "SV_dnAkDKOddKsPTpQ",
      "Element": "RS",
      "PrimaryAttribute": "RS_6zXdxkXXWoWLKL4",
      "SecondaryAttribute": "Default Response Set",
      "TertiaryAttribute": null,
      "Payload": null
    },
    {
      "SurveyID": "SV_dnAkDKOddKsPTpQ",
      "Element": "SQ",
      "PrimaryAttribute": "QID1",
      "SecondaryAttribute": "This loads parameters.",
      "TertiaryAttribute": null,
      "Payload": {
        "QuestionText": "This loads parameters.",
        "DefaultChoices": false,
        "DataExportTag": "LoadParameters",
        "QuestionID": "QID1",
        "QuestionType": "DB",
        "Selector": "TB",
        "DataVisibility": {
          "Private": false,
          "Hidden": false
        },
        "Configuration": {
          "QuestionDescriptionOption": "UseText"
        },
        "QuestionDescription": "This loads parameters.",
        "ChoiceOrder": [],
        "Validation": {
          "Settings": {
            "Type": "None"
          }
        },
        "GradingData": [],
        "Language": [],
        "NextChoiceId": 4,
        "NextAnswerId": 1,
        "QuestionJS": "\"use strict\";\n\nfunction _typeof(obj) { \"@babel\/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e2) { throw _e2; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e3) { didErr = true; err = _e3; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || \/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$\/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(arr, i) { var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (null != _i) { var _s, _e, _x, _r, _arr = [], _n = !0, _d = !1; try { if (_x = (_i = _i.call(arr)).next, 0 === i) { if (Object(_i) !== _i) return; _n = !1; } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0); } catch (err) { _d = !0, _e = err; } finally { try { if (!_n && null != _i[\"return\"] && (_r = _i[\"return\"](), Object(_r) !== _r)) return; } finally { if (_d) throw _e; } } return _arr; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nvar myGlobalThis = window.top;\nmyGlobalThis.qs = Qualtrics.SurveyEngine; \/\/ for debug\n\nvar params = loadParams();\nmyGlobalThis.params = params;\nconsole.log('[AMP Gen] Loaded parameters', myGlobalThis.params);\nparams.stimuli.forEach(function (stimuli, stimuliIndex) {\n  if (stimuli.prime) {\n    stimuli.items = applyAndOutputPrime(stimuli, stimuliIndex, findPrime(stimuli.items.length, stimuli.prime));\n  }\n  stimuli.shuffledIndexes = shuffledIndexes(stimuli);\n  outputShuffle(stimuli.shuffledIndexes, stimuliIndex);\n  applyPreload(stimuli.items.map(function (_ref) {\n    var content = _ref.content;\n    return content;\n  }));\n});\n\n\/** \n * @typedef {Object} StimuliPrimeItem\n * @property {string} name\n * @property {(string|number)[]|null} include\n * @property {(string|number)[]|null} exclude\n * @property {number|null} overrideCount\n *\/\n\/** \n * @typedef {Object} StimuliPoolConfig\n * @property {{content:string, count:number}[]} items\n * @property {boolean|number} shuffle\n * @property {StimuliPrimeItem[]|null} prime\n *\/\n\/**\n * @typedef {Object} Params\n * @property {StimuliPoolConfig[]} stimuli\n * @property {number[]} timeline\n * @property {string[]} acceptedKeys\n * @property {number} totalTrials\n * @property {number|null} autoProceedTimeout\n *\/\n\n\/**\n * @returns {Params}\n *\/\nfunction loadParams() {\n  try {\n    return {\n      stimuli: [0, 1, 2].map(loadStimuliPoolConfig),\n      timeline: [parseFloat(_('stimuli_1_duration')) || 0, parseFloat(_('stimuli_1_interval')) || 0, parseFloat(_('stimuli_2_duration')) || 0, parseFloat(_('stimuli_2_interval')) || 0, parseFloat(_('delay_before_keyboard')) || 0, parseFloat(_('delay_after_keyboard')) || 0],\n      acceptedKeys: _('accepted_keys').split(','),\n      totalTrials: parseInt(_('total_trials')),\n      autoProceedTimeout: function (x) {\n        return isNaN(x) ? null : x;\n      }(parseFloat(_('auto_proceed_timeout')))\n    };\n  } catch (e) {\n    alert(\"Error when loading parameters. Error message:\\n \".concat(e));\n  }\n\n  \/**\n   * @param {string} stimuliIndex \n   * @returns {StimuliPoolConfig}\n   *\/\n  function loadStimuliPoolConfig(stimuliIndex) {\n    \/\/ Items\n    var json = _(\"stimuli_\".concat(stimuliIndex + 1, \"_items\"));\n    console.debug(\"stimuli_\".concat(stimuliIndex + 1, \"_items\"), json);\n    var items = JSON.parse(json);\n    console.debug(items);\n    \/\/ TODO: param validation here\n\n    \/\/ Priming\n    var primeJson = _(\"stimuli_\".concat(stimuliIndex + 1, \"_prime\"));\n    var prime = primeJson ? JSON.parse(primeJson).map(function (primeJsonItem) {\n      var _primeJsonItem$includ, _primeJsonItem$includ2, _primeJsonItem$exclud, _primeJsonItem$exclud2, _primeJsonItem$overri;\n      return {\n        name: primeJsonItem.name,\n        include: (_primeJsonItem$includ = (_primeJsonItem$includ2 = primeJsonItem.include) === null || _primeJsonItem$includ2 === void 0 ? void 0 : _primeJsonItem$includ2.map(function (item) {\n          return typeof item === 'number' ? item - 1 : item;\n        })) !== null && _primeJsonItem$includ !== void 0 ? _primeJsonItem$includ : null,\n        exclude: (_primeJsonItem$exclud = (_primeJsonItem$exclud2 = primeJsonItem.exclude) === null || _primeJsonItem$exclud2 === void 0 ? void 0 : _primeJsonItem$exclud2.map(function (item) {\n          return typeof item === 'number' ? item - 1 : item;\n        })) !== null && _primeJsonItem$exclud !== void 0 ? _primeJsonItem$exclud : null,\n        overrideCount: (_primeJsonItem$overri = primeJsonItem.override_count) !== null && _primeJsonItem$overri !== void 0 ? _primeJsonItem$overri : null\n      };\n    }) : null;\n\n    \/\/ Shuffle\n    \/\/ boolean or int > 0\n    var shuffle = function (shuffleConfig) {\n      if (shuffleConfig === 'true') return true;\n      var shuffleConfigInt = parseInt(shuffleConfig);\n      if (shuffleConfigInt > 0) return shuffleConfigInt;\n      return false;\n    }(_(\"stimuli_\".concat(stimuliIndex + 1, \"_shuffle\")));\n    return {\n      items: items,\n      shuffle: shuffle,\n      prime: prime\n    };\n  }\n}\n\n\/**\n * @param {StimuliPoolConfig} stimuli  \n * @returns {number[]}\n *\/\nfunction shuffledIndexes(stimuli) {\n  var items = stimuli.items,\n    shuffle = stimuli.shuffle;\n  var indexes = getIndexesRepresentation(items);\n  if (shuffle >= 1) {\n    shuffleWithMaxRepeat(indexes, shuffle);\n  } else if (shuffle) {\n    shuffleArray(indexes);\n  }\n  return indexes;\n\n  \/**\n   * Represent pool with indexes rather than the actual content, rotationally\n   * e.g. [{count:2},{count:3},{count:1}] -> [0,1,2,0,1,1]\n   * @param {{count: number}[]} items \n   * @returns {number[]}\n   *\/\n  function getIndexesRepresentation(items) {\n    var indexes = [];\n    var counts = items.map(function (item, index) {\n      return [index, item.count];\n    });\n    while (true) {\n      var remainingIndexes = counts.filter(function (_ref2) {\n        var _ref3 = _slicedToArray(_ref2, 2),\n          index = _ref3[0],\n          count = _ref3[1];\n        return count > 0;\n      }).map(function (_ref4) {\n        var _ref5 = _slicedToArray(_ref4, 2),\n          index = _ref5[0],\n          count = _ref5[1];\n        return index;\n      });\n      if (remainingIndexes.length) {\n        indexes.push.apply(indexes, _toConsumableArray(remainingIndexes));\n        remainingIndexes.map(function (index) {\n          return counts[index][1]--;\n        });\n      } else {\n        break;\n      }\n    }\n    return indexes;\n  }\n\n  \/\/ Shuffles \"array\" in situ\n  function shuffleArray(array) {\n    for (var i = array.length - 1; i > 0; i--) {\n      var j = Math.floor(Math.random() * (i + 1));\n      var temp = array[i];\n      array[i] = array[j];\n      array[j] = temp;\n    }\n  }\n\n  \/\/ Shuffles \"array\" in situ, with promise that no item will repeat \"maxRepeat\" times consecutively\n  function shuffleWithMaxRepeat(array, maxRepeat) {\n    var MAX_TRY = 100; \/\/ if cannot satisfy after too many tries, stop shuffling and ignore maxRepeat\n    var validate = function validate() {\n      var repeatItem, repeatTimes;\n      var _iterator = _createForOfIteratorHelper(array),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var i = _step.value;\n          if (i === repeatItem) {\n            if (repeatTimes === maxRepeat) {\n              return false;\n            } else {\n              repeatTimes++;\n            }\n          } else {\n            repeatItem = i;\n            repeatTimes = 1;\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n      return true;\n    };\n    for (var i = 0; i < MAX_TRY; i++) {\n      shuffleArray(array);\n      if (validate()) return;\n    }\n  }\n}\n\n\/**\n * @param {number[]} indexes \n * @param {string} stimuliIndex \n * @return {void}\n *\/\nfunction outputShuffle(indexes, stimuliIndex) {\n  var shuffleResult = indexes.join(',');\n  var shuffleResultName = \"stimuli_\".concat(stimuliIndex + 1, \"_shuffle_result\");\n  _set(shuffleResultName, shuffleResult);\n}\n\n\/** \n * @typedef {Record.<string, number|null>} PrimeResult primeName -> stimulusItemIndex\n *\/\n\/**\n * Get indexes for primes\n * @param {number} itemsLength\n * @param {StimuliPoolConfig['prime']} prime\n * @returns {PrimeResult}\n *\/\nfunction findPrime(itemsLength, prime) {\n  if (prime === null) {\n    return {};\n  }\n  \/** @type {Record.<string, number|null>} *\/\n  var primeResult = {};\n  var _iterator2 = _createForOfIteratorHelper(prime),\n    _step2;\n  try {\n    for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n      var _step2$value = _step2.value,\n        name = _step2$value.name,\n        include = _step2$value.include,\n        exclude = _step2$value.exclude;\n      \/\/ Babel has issue: after Set.delete() cannot transform Set to Array\n      var includeIndexes = include === null || include === void 0 ? void 0 : include.map(function (i) {\n        return typeof i === 'number' ? i : primeResult[i];\n      }).filter(function (i) {\n        return i !== null;\n      });\n      var excludeIndexes = exclude === null || exclude === void 0 ? void 0 : exclude.map(function (i) {\n        return typeof i === 'number' ? i : primeResult[i];\n      }).filter(function (i) {\n        return i !== null;\n      });\n      var resolvedStimuliIndexes = includeExclude(includeIndexes !== null && includeIndexes !== void 0 ? includeIndexes : range(itemsLength), excludeIndexes);\n      var result = randomChoice(resolvedStimuliIndexes);\n      primeResult[name] = result;\n    }\n  } catch (err) {\n    _iterator2.e(err);\n  } finally {\n    _iterator2.f();\n  }\n  console.debug('primeResult', primeResult);\n  return primeResult;\n  function includeExclude(include, exclude) {\n    var result = [];\n    include.forEach(function (i) {\n      return !result.includes(i) && result.push(i);\n    });\n    if (!exclude) {\n      return result;\n    } else {\n      return result.filter(function (i) {\n        return !exclude.includes(i);\n      });\n    }\n  }\n  function randomChoice(list) {\n    return list[Math.floor(Math.random() * list.length)];\n  }\n  \/**\n   * Randomly select from [0...end-1] \\ excludes\n   * @deprecated\n   * @param {number} end \n   * @param {(number|null)[]|undefined} excludes\n   * @returns {number|null}\n   *\/\n  function randRangeExclude(end) {\n    var excludes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n    var effectiveExcludes = _toConsumableArray(new Set(excludes)).filter(function (e) {\n      return e !== null && e < end;\n    }); \/\/ dedupe and clean\n    var randRange = end - effectiveExcludes.length;\n    if (randRange <= 0) {\n      return null;\n    }\n    var indexInGappedArray = Math.floor(Math.random() * randRange);\n    \/\/ In this piecewise mapping, the offset is i for values between (E[i-1], E[i]), \n    \/\/ i.e. indexes between (E[i-1] - i, E[i] - i) == [E[i-1] - (i-1), E[i] - i)\n    var offset = [].concat(_toConsumableArray(effectiveExcludes), [Infinity]).findIndex(function (e, i) {\n      return e - i > indexInGappedArray;\n    }); \/\/ find first valid upper bound\n    return indexInGappedArray + offset;\n  }\n}\n\n\/**\n * \n * @param {StimuliPoolConfig} stimuli\n * @param {number} stimuliIndex\n * @param {PrimeResult} primeResult\n *\/\nfunction applyAndOutputPrime(stimuli, stimuliIndex, primeResult) {\n  var primeResultOutput = mapObject(primeResult, function (x) {\n    return x === null ? null : x + 1;\n  });\n  _set(\"stimuli_\".concat(stimuliIndex + 1, \"_prime_result\"), JSON.stringify(primeResultOutput));\n  var items = stimuli.items,\n    prime = stimuli.prime;\n  var newStimuliItems = items.map(function (s) {\n    return _objectSpread({}, s);\n  });\n  var _loop = function _loop() {\n    var _Object$entries$_i = _slicedToArray(_Object$entries[_i2], 2),\n      primeName = _Object$entries$_i[0],\n      primeResultValue = _Object$entries$_i[1];\n    if (primeResultValue !== null) {\n      var _prime$find;\n      var newStimuliItem = newStimuliItems[primeResultValue];\n      var primeOverrideCount = (_prime$find = prime.find(function (p) {\n        return p.name === primeName;\n      })) === null || _prime$find === void 0 ? void 0 : _prime$find.overrideCount;\n      if (typeof primeOverrideCount === 'number') {\n        newStimuliItem.count = primeOverrideCount;\n      }\n      _set(\"stimuli_\".concat(stimuliIndex + 1, \"_prime_\").concat(primeName, \"_index\"), \"\".concat(primeResultValue + 1));\n      _set(\"stimuli_\".concat(stimuliIndex + 1, \"_prime_\").concat(primeName, \"_content\"), newStimuliItem.content);\n      _set(\"stimuli_\".concat(stimuliIndex + 1, \"_prime_\").concat(primeName, \"_count\"), newStimuliItem.count);\n    }\n  };\n  for (var _i2 = 0, _Object$entries = Object.entries(primeResult); _i2 < _Object$entries.length; _i2++) {\n    _loop();\n  }\n  return newStimuliItems;\n}\n\n\/**\n * Preload images. Return a copy of the array but the items will be replaced with preloaded blobs asynchronously.\n * Preloaded images are stored in object `myGlobalThis.preload`\n * (We cannot directly use http cache to preload image, because Qualtrics sets the cache to expire in 60s (`cache-control: max-age=60`))\n * (Thus, use blobs.)\n * @param {string[]} contents\n * @returns {void}\n *\/\nfunction applyPreload(contents) {\n  if (myGlobalThis.preload === undefined) {\n    myGlobalThis.preload = {};\n  }\n  var _iterator3 = _createForOfIteratorHelper(contents),\n    _step3;\n  try {\n    var _loop2 = function _loop2() {\n      var content = _step3.value;\n      \/\/ if already preloaded, skip\n      if (myGlobalThis.preload[content] !== undefined) return {\n        v: void 0\n      };\n      \/\/ if content starts with 'http(s):\/\/'\n      if (\/^https?:\\\/\\\/\/.test(content)) {\n        createImageBlob(content, function (e, blob) {\n          if (blob) {\n            console.debug('Preload blob created:', blob);\n            myGlobalThis.preload[content] = blob;\n          } else {\n            console.debug('Preload blob error:', e);\n          }\n        });\n      } else {\n        console.debug('Preload skipped for non-url content:', content);\n      }\n    };\n    for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n      var _ret = _loop2();\n      if (_typeof(_ret) === \"object\") return _ret.v;\n    }\n  } catch (err) {\n    _iterator3.e(err);\n  } finally {\n    _iterator3.f();\n  }\n  ;\n  function createImageBlob(url, callback) {\n    var xhr = new XMLHttpRequest();\n    xhr.open('GET', url, true);\n    xhr.responseType = 'blob';\n    xhr.onload = function () {\n      if (this.status === 200 || this.status === 304) {\n        callback(null, URL.createObjectURL(this.response));\n      } else {\n        callback(new Error('Request failed with status ' + this.status));\n      }\n    };\n    xhr.onerror = function () {\n      callback(new Error('Network error'));\n    };\n    xhr.send();\n  }\n}\n\n\/**\n * @param {string} name \n * @returns {string|null}\n *\/\nfunction _(name) {\n  return Qualtrics.SurveyEngine.getEmbeddedData(name);\n}\nfunction _set(name, value) {\n  console.log(\"[AMP] set \".concat(name, \" = \").concat(value));\n  Qualtrics.SurveyEngine.setEmbeddedData(name, value);\n}\n\n\/**\n * @template K, V, W\n * @param {Record.<K, V>} obj \n * @param {function(V): W} mapper \n * @returns {Record.<K, W>}\n *\/\nfunction mapObject(obj, mapper) {\n  return Object.fromEntries(Object.entries(obj).map(function (_ref6) {\n    var _ref7 = _slicedToArray(_ref6, 2),\n      key = _ref7[0],\n      value = _ref7[1];\n    return [key, mapper(value)];\n  }));\n}\nfunction range(n) {\n  var result = [];\n  for (var i = 0; i < n; i++) {\n    result.push(i);\n  }\n  return result;\n}"
      }
    }
  ]
}